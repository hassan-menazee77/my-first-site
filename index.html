<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Simple Calculator</title>
    <meta name="description" content="A simple web calculator" />
    <link rel="manifest" href="manifest.json" />
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-X494HX871P"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-X494HX871P');
    </script>
    <style>
      :root{ --accent:#00f2ff; --text:#f8fafc; }
      html,body{height:100%;margin:0;font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#0f0c29,#302b63,#24243e);background-size:400% 400%;animation:g 15s ease infinite;color:var(--text);display:flex;align-items:center;justify-content:center;overflow:hidden}
      @keyframes g{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
      .calc{background:rgba(255,255,255,0.05);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,0.2);border-radius:24px;padding:24px;width:340px;box-shadow:0 0 40px rgba(0,242,255,0.15), 0 20px 50px rgba(0,0,0,0.5);transition:transform .3s}
      .display{background:rgba(0,0,0,0.3);border-radius:12px;padding:20px;color:var(--accent);font-size:36px;text-align:right;min-height:80px;box-sizing:border-box;border:1px solid rgba(255,255,255,0.1);text-shadow:0 0 20px var(--accent), 0 0 40px var(--accent);margin-bottom:20px;word-wrap:break-word;word-break:break-all;font-weight:300;box-shadow:inset 0 0 20px rgba(0,0,0,0.5)}
      .keys{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
      button{background:rgba(255,255,255,0.05);border:none;color:rgba(255,255,255,0.9);padding:16px;border-radius:16px;font-size:20px;cursor:pointer;transition:all .2s cubic-bezier(0.4,0,0.2,1);position:relative;overflow:hidden}
      button::after{content:'';position:absolute;top:50%;left:50%;width:0;height:0;background:rgba(255,255,255,0.2);border-radius:50%;transform:translate(-50%,-50%);transition:width .3s,height .3s}
      button:active::after{width:200px;height:200px}
      button:hover{background:rgba(255,255,255,0.2);transform:translateY(-3px);box-shadow:0 0 25px rgba(255,255,255,0.3);color:#fff;border:1px solid rgba(255,255,255,0.3)}
      button:active{transform:scale(0.95)}
      .op{color:var(--accent);font-weight:bold;background:rgba(0,242,255,0.15);box-shadow:0 0 15px rgba(0,242,255,0.1)}
      .op:hover{background:rgba(0,242,255,0.3);box-shadow:0 0 40px var(--accent), 0 0 10px #fff}
      .wide{grid-column:span 2}
      footer{margin-top:20px;font-size:11px;color:rgba(255,255,255,0.4);text-align:center;letter-spacing:0.5px}
      @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}
      .shake{animation:shake 0.4s ease-in-out}
      @media (max-width:360px){.calc{width:90vw;padding:16px}}
      .history{margin-bottom:10px;padding:10px;background:rgba(0,0,0,0.2);border-radius:8px;text-align:right;font-size:13px;color:rgba(255,255,255,0.6);height:80px;overflow:hidden;display:flex;flex-direction:column;justify-content:flex-end;box-shadow:inset 0 0 5px rgba(0,0,0,0.3)}
      .history div{margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    </style>
  </head>
  <body>
    <main class="calc" role="application" aria-label="Calculator">
      <div id="history" class="history"></div>
      <div id="display" class="display" role="textbox" aria-readonly="true" aria-live="polite">0</div>

      <div class="keys">
        <button type="button" data-action="clear" style="color:#ff6b6b">C</button>
        <button type="button" data-value="(">(</button>
        <button type="button" data-value=")">)</button>
        <button type="button" data-action="back">⌫</button>

        <button type="button" data-value="√(">√</button>
        <button type="button" data-value="^2">x²</button>
        <button type="button" data-value="π">π</button>
        <button type="button" class="op" data-value="/">÷</button>

        <button type="button" data-value="7">7</button>
        <button type="button" data-value="8">8</button>
        <button type="button" data-value="9">9</button>
        <button type="button" class="op" data-value="*">×</button>

        <button type="button" data-value="4">4</button>
        <button type="button" data-value="5">5</button>
        <button type="button" data-value="6">6</button>
        <button type="button" class="op" data-value="-">−</button>

        <button type="button" data-value="1">1</button>
        <button type="button" data-value="2">2</button>
        <button type="button" data-value="3">3</button>
        <button type="button" class="op" data-value="+">+</button>

        <button type="button" data-value="0">0</button>
        <button type="button" data-value=".">.</button>
        <button type="button" data-value="%">%</button>
        <button type="button" class="op" data-action="equals">=</button>
      </div>

      <footer>Keyboard support: type numbers and + - * /, Enter to evaluate, Backspace to delete. — © 2026 جميع الحقوق محفوظة لـ Hassan Menazee</footer>
    </main>

    <script>
      (function(){
        const display = document.getElementById('display');
        const calc = document.querySelector('.calc');
        const historyDiv = document.getElementById('history');
        let expr = '';

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound() {
          if (audioCtx.state === 'suspended') audioCtx.resume();
          const osc = audioCtx.createOscillator();
          const gain = audioCtx.createGain();
          osc.connect(gain);
          gain.connect(audioCtx.destination);
          osc.frequency.setValueAtTime(600, audioCtx.currentTime);
          gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.1);
          osc.start();
          osc.stop(audioCtx.currentTime + 0.1);
        }

        function update(){
          display.textContent = expr || '0';
        }

        function addHistory(expression, result){
          const line = document.createElement('div');
          line.textContent = `${expression} = ${result}`;
          historyDiv.appendChild(line);
          if(historyDiv.children.length > 5) historyDiv.removeChild(historyDiv.firstChild);
        }

        function safeEvaluate(s){
          if(!/^[0-9+\-*/().%\s^π√]+$/.test(s)) throw new Error();
          s = s.replace(/%/g, '/100');
          s = s.replace(/\^/g, '**');
          s = s.replace(/√/g, 'Math.sqrt');
          s = s.replace(/π/g, 'Math.PI');
          return Function('return ('+s+')')();
        }

        function errorAnim(){
          calc.classList.add('shake');
          setTimeout(()=>calc.classList.remove('shake'), 400);
        }

        document.querySelector('.keys').addEventListener('click', e=>{
          const btn = e.target.closest('button');
          if(!btn) return;
          playSound();
          const val = btn.getAttribute('data-value');
          const action = btn.getAttribute('data-action');

          if(action === 'clear'){ expr = ''; update(); return }
          if(action === 'back'){ expr = expr.slice(0,-1); update(); return }
          if(action === 'equals'){ try{ const result = safeEvaluate(expr); addHistory(expr, result); expr = String(result); }catch(e){ expr = 'Error'; errorAnim(); } update(); return }
          if(expr === 'Error') expr = '';
          expr += val; update();
        });

        window.addEventListener('keydown', e=>{
          if((e.key >= '0' && e.key <= '9') || ['+','-','*','/','.','(',')','%','^'].includes(e.key)){
            playSound();
            if(expr === 'Error') expr = '';
            expr += e.key; update(); e.preventDefault();
            return;
          }
          if(e.key === 'Enter'){
            playSound();
            try{ const result = safeEvaluate(expr); addHistory(expr, result); expr = String(result); }catch(err){ expr = 'Error'; errorAnim(); } update(); e.preventDefault(); return;
          }
          if(e.key === 'Backspace'){ playSound(); expr = expr.slice(0,-1); update(); e.preventDefault(); return; }
          if(e.key.toLowerCase() === 'c'){ playSound(); expr = ''; update(); e.preventDefault(); return; }
        });

        update();
      })();
    </script>
  </body>
</html>